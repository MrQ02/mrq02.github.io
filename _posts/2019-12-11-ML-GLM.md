---
layout: post
title: "GLM"
date: 2019-12-01 22:29:53 +0900
permalink: /ML/GLM/
header-includes:
- \usepackage{amsmath}
---

## Generalized Linear Models (GLM)

- What are **GLM**s?  


    Remember the two models we had in the last post?  
    Regression:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$p(y|x,w)\sim N(\mu,\sigma^2)$  
    Classification: &nbsp;&nbsp;$p(y|x,w)\sim \text{Bernoulli}(\phi)$  
    
    They belong to GLM, a collection of models that can be applied to Supervised Learning problems. We will show more examples of GLMs in this markdown.

- **Exponential Family**

    $$\begin{equation}
    p(y,\eta)=b(y)\cdot e^{\eta^TT(y)-a(\eta)}
    \end{equation}$$
    
    1. $\eta$: natural parameter (i.e. canonical parameter)  
        
        &emsp;different $\eta \rightarrow$ different distributions within the family
        
    2. $T(y)$: sufficient statistic (usually, $T(y)=y$)  
        
    3. $a(\eta)$: log partition function  
        
    4. $e^{-a(\eta)}$: normalization constant (to ensure that $\int{p(y,\eta)dy}=1$) 
        
    5. $T,a,b$: fixed choice that defines a family of distributions parametrized by $\eta$
    
- Example 1: **Bernoulli Distribution (Classification)**

    $$\begin{align}
    p(y|\phi)&=\phi^y(1-\phi)^{1-y} \\
    &=e^{y\log{\phi}+(1-y)\log{(1-\phi)}} \\
    &=e^{y\log{\frac{\phi}{1-\phi}}+\log{(1-\phi)}} \\
    \end{align}$$
    
    1. $\eta=\log{\frac{\phi}{1-\phi}}\Leftrightarrow \phi=\frac{1}{1+e^{-\eta}}$
        
    2. $T(y)=y$
        
    3. $a(\eta)=\log{(1+e^\eta)}$
        
    4. $b(y)=1$  
    &nbsp;
    
- Example 2: **Gaussian Distribution (Regression)**

    $$\begin{align}
    p(y|\mu,\sigma^2)&=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{1}{2\sigma^2}(y-\mu)^2} \\
    &=\frac{1}{\sqrt{2\pi}}e^{\frac{\mu}{\sigma^2}y-\frac{1}{2\sigma^2}y^2-\frac{1}{2\sigma^2}\mu^2-\log{\sigma}}
    \end{align}$$
    
    1. $\eta=\begin{bmatrix}
           \frac{\mu}{\sigma^2} ;
           \frac{-1}{2\sigma^2}
          \end{bmatrix}$
              
    2. $T(y)=\begin{bmatrix}
           y;
           y^2
          \end{bmatrix}$
              
    3. $a(\eta)=\frac{1}{2\sigma^2}\mu^2-\log{\sigma}=-\frac{\eta_1^2}{4\eta_2}-\frac{1}{2}\log{(-2\eta_2)}$
        
    4. $b(y)=\frac{1}{\sqrt{2\pi}}$
    &nbsp;
    
- Example 3: **Poisson Distribution** (count-data)

    $$\begin{align}
    p(y|\lambda)&=\frac{\lambda^ye^{-\lambda}}{y!}\\
    &=\frac{1}{y!}e^{y\log{\lambda}-\lambda}
    \end{align}$$
    
    1. $\eta=\log{\lambda}$
        
    2. $T(y)=y$
        
    3. $a(\eta)=e^\eta$
        
    4. $b(y)=\frac{1}{y!}$  
    &nbsp;
    
- Example 4: **Gamma Distribution** (continuous non-negative random variables)

    $$\begin{align}
    p(y|\lambda,a)&=\frac{\lambda^ay^{a-1}e^{-\lambda y}}{\Gamma(a)}\\
    &=\frac{y^{a-1}}{\Gamma(a)}e^{-\lambda y+a\log{\lambda}}
    \end{align}$$
    
    1. $\eta=-\lambda$
        
    2. $T(y)=y$
        
    3. $a(\eta)=-a\log{(-\eta)}$
        
    4. $b(y)=\frac{y^{a-1}}{\Gamma(a)}$  
    &nbsp;
    
    
- Example 5: **Beta Distribution** (distribution of probabilities)

    $$\begin{align}
    p(y|\alpha,\beta)&=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}y^{\alpha-1}(1-y)^{\beta-1} \\
    &=\frac{(1-y)^\beta}{y(1-y)\Gamma(\beta)}e^{\alpha\log{y}- \log{\frac{\Gamma(\alpha)}{\Gamma(\alpha+\beta)}}} \\
    &=\frac{y^\alpha}{y(1-y)\Gamma(\alpha)}e^{\beta\log{(1-y)}- \log{\frac{\Gamma(\beta)}{\Gamma(\alpha+\beta)}}}
    \end{align}$$
    
    1. $\eta=\alpha\ \text{or}\ \beta$
        
    2. $T(y)=\log{y}\ \text{or}\ \log{(1-y)}$
        
    3. $a(\eta)=\log{\frac{\Gamma(\eta)}{\Gamma(\alpha+\beta)}}$
        
    4. $b(y)=\frac{(1-y)^\beta}{y(1-y)\Gamma(\beta)}\ \text{or}\ \frac{y^\alpha}{y(1-y)\Gamma(\alpha)}$  
    &nbsp;
    
- Example 6: **Dirichlet Distribution** (multivariate beta)

    $$\begin{align}
    p(y|\alpha)&=\frac{\Gamma(\sum_k\alpha_k)}{\prod_k\Gamma(\alpha_k)}\prod_k{y_k^{\alpha_k-1}} \\
    &=\exp{\{\sum_k{(\alpha_k-1)\log{y_k}}-[\sum_k{\log{\Gamma(\alpha_k)}}-\log{\Gamma(\sum_k{\alpha_k})}]\}}
    \end{align}$$
    
    1. $\eta=\alpha-1$
        
    2. $T(y)=\log{y}$
        
    3. $a(\eta)=\sum_k{\log{\Gamma(\alpha_k)}}-\log{\Gamma(\sum_k{\alpha_k})}$
        
    4. $b(y)=1$  
    &nbsp;
    
    
    
    
    
    
    
    
